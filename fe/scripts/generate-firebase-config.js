
import fs from 'fs';
import path from 'path';
import { fileURLToPath } from 'url';
const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);
function firebaseConfigWrite() {
	const FIREBASE_CONFIG_FILE = path.resolve(__dirname, '../src/config/firebase-config.ts');

	const FIREBASE_CONFIG_ENV_VAR = 'FIREBASE_CONFIG';

	try {
		if (!process.env[FIREBASE_CONFIG_ENV_VAR]) {
			// throw new Error(`Missing required environment variable: ${FIREBASE_CONFIG_ENV_VAR}. Please set it.`);
			console.log("Environment var " + FIREBASE_CONFIG_ENV_VAR + " not set");
			return
		}

		const firebaseConfigContent = `
// This file is auto-generated by vite.config.js
// Do not edit this file directly.

export const firebaseConfig = ${process.env[FIREBASE_CONFIG_ENV_VAR]};
`;
		// todo: dont write if exists

		fs.writeFileSync(FIREBASE_CONFIG_FILE, firebaseConfigContent.trim());
		console.log(`Generated ${FIREBASE_CONFIG_FILE} successfully!`);

	} catch (error) {
		if (error instanceof Error)
			console.error(`Error generating Firebase config file: ${error.message}`);
		process.exit(1);
	}
}
firebaseConfigWrite()
